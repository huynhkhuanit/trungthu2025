<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ch√∫c m·ª´ng Trung Thu 2025</title>
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      background: linear-gradient(to bottom, #0b0f2f, #1a1a40);
      color: white;
      font-family: 'Poppins', sans-serif;
      text-align: center;
      min-height: 100vh;
      padding: 20px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    h1 {
      font-size: 2.5rem;
      margin-bottom: 20px;
      text-shadow: 0 0 10px rgba(255,255,255,0.3);
    }

    p {
      font-size: 1.1rem;
      margin-bottom: 30px;
      line-height: 1.6;
      max-width: 400px;
    }

    input {
      padding: 15px;
      border-radius: 12px;
      border: 2px solid rgba(255,255,255,0.2);
      outline: none;
      font-size: 16px;
      width: 100%;
      max-width: 300px;
      margin-bottom: 20px;
      background: rgba(255,255,255,0.1);
      color: white;
      transition: all 0.3s ease;
    }

    input:focus {
      border-color: #ffcc00;
      background: rgba(255,255,255,0.15);
      box-shadow: 0 0 15px rgba(255,204,0,0.3);
    }

    input::placeholder {
      color: rgba(255,255,255,0.7);
    }

    button {
      margin-top: 15px;
      padding: 15px 30px;
      border: none;
      background: linear-gradient(135deg, #ffcc00, #ffb347);
      color: #222;
      font-weight: bold;
      border-radius: 12px;
      cursor: pointer;
      font-size: 1.1rem;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(255,204,0,0.3);
    }

    button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(255,204,0,0.4);
    }

    button:active {
      transform: translateY(0);
    }

    @media (max-width: 768px) {
      body {
        padding: 15px;
      }

      h1 {
        font-size: 2rem;
        margin-bottom: 15px;
      }

      p {
        font-size: 1rem;
        margin-bottom: 25px;
      }

      input {
        padding: 12px;
        font-size: 16px;
        background: rgba(255,255,255,0.15);
      }

      button {
        padding: 12px 25px;
        font-size: 1rem;
      }
    }

    @media (max-width: 480px) {
      h1 {
        font-size: 1.8rem;
      }

      p {
        font-size: 0.95rem;
      }

      input {
        max-width: 100%;
        padding: 10px;
      }
    }
  </style>
</head>
<body>
  <h1>üéë Trung Thu 2025 üéë</h1>
  <p>Nh·∫≠p ng√†y sinh c·ªßa c·∫≠u ƒë·ªÉ m·ªü qu√† b·∫•t ng·ªù nh√© üíñ</p>
  <input type="text" id="dob" placeholder="dd/mm/yyyy" maxlength="10" data-birth="70/90/6002" data-decoys="56/39/5076,37/64/7088,97/75/5075,14/86/7099" autocomplete="off">
  <button onclick="checkDOB()">V√†o xem</button>

  <audio id="backgroundMusic" loop preload="auto">
    <source src="trungthu2025.mp3" type="audio/mpeg">
    Your browser does not support the audio element.
  </audio>

  <script>
    function checkDOB() {
      const dobInput = document.getElementById('dob').value;

      const datePattern = /^(\d{2})\/(\d{2})\/(\d{4})$/;
      if (!datePattern.test(dobInput)) {
        alert("Vui l√≤ng nh·∫≠p ng√†y sinh theo ƒë·ªãnh d·∫°ng dd/mm/yyyy üòä");
        return;
      }

      const [, day, month, year] = dobInput.match(datePattern);

      const birthDate = new Date(year, month - 1, day);
      const isValidDate = birthDate.getDate() == day &&
                         birthDate.getMonth() == month - 1 &&
                         birthDate.getFullYear() == year;

      if (!isValidDate) {
        alert("Ng√†y sinh kh√¥ng h·ª£p l·ªá! Vui l√≤ng ki·ªÉm tra l·∫°i üòÖ");
        return;
      }

      const formattedDate = `${year}-${month.padStart(2, '0')}-${day.padStart(2, '0')}`;

      const correctDateElement = document.getElementById('dob');
      const encodedDate = correctDateElement.getAttribute('data-birth');

      if (!encodedDate) {
        alert("C√≥ l·ªói x·∫£y ra! Vui l√≤ng th·ª≠ l·∫°i.");
        return;
      }

      function decodeDate(encoded) {
        return encoded.split('/').map(part =>
          part.split('').reverse().join('')
        ).join('/');
      }

      const correctDateInput = decodeDate(encodedDate);

      const [correctDay, correctMonth, correctYear] = correctDateInput.split('/');
      const correctFormattedDate = `${correctYear}-${correctMonth.padStart(2, '0')}-${correctDay.padStart(2, '0')}`;

      if(formattedDate === correctFormattedDate) {
        window.location.href = "intro.html";
      } else {
        alert("Sai r·ªìi nha üòú, ch·ªâ c√≥ c·∫≠u m·ªõi v√†o ƒë∆∞·ª£c!");
      }
    }

    document.addEventListener('DOMContentLoaded', function() {
      const dobInput = document.getElementById('dob');
      const backgroundMusic = document.getElementById('backgroundMusic');

      function playBackgroundMusic() {
        if (backgroundMusic) {
          const savedTime = sessionStorage.getItem('audioCurrentTime');
          const savedVolume = sessionStorage.getItem('audioVolume');

          if (savedVolume) {
            backgroundMusic.volume = parseFloat(savedVolume);
          } else {
            backgroundMusic.volume = 0.4;
          }

          backgroundMusic.play().then(() => {
            if (savedTime) {
              backgroundMusic.currentTime = parseFloat(savedTime);
            }
          }).catch(e => {
            console.log('Kh√¥ng th·ªÉ ph√°t nh·∫°c n·ªÅn:', e.message);
          });
        }
      }

      playBackgroundMusic();

      document.addEventListener('click', playBackgroundMusic, { once: true });
      document.addEventListener('touchstart', playBackgroundMusic, { once: true });

      function saveAudioState() {
        if (backgroundMusic) {
          sessionStorage.setItem('audioCurrentTime', backgroundMusic.currentTime.toString());
          sessionStorage.setItem('audioVolume', backgroundMusic.volume.toString());
        }
      }

      setInterval(saveAudioState, 1000);

      window.addEventListener('beforeunload', saveAudioState);

      dobInput.addEventListener('input', function(e) {
        let value = e.target.value;

        value = value.replace(/[^\d/]/g, '');

        const numbersOnly = value.replace(/\//g, '');

        let formattedValue = '';

        if (numbersOnly.length >= 1) {
          if (numbersOnly.length <= 2) {
            formattedValue = numbersOnly;
          } else if (numbersOnly.length <= 4) {
            formattedValue = numbersOnly.substring(0, 2) + '/' + numbersOnly.substring(2);
          } else {
            formattedValue = numbersOnly.substring(0, 2) + '/' + numbersOnly.substring(2, 4) + '/' + numbersOnly.substring(4, 8);
          }
        }

        e.target.value = formattedValue;
      });
    });
  </script>
</body>
</html>
